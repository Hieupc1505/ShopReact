{"ast":null,"code":"import { USER_LOGIN_REQUEST, USER_LOGIN_SUCCESS, USER_AUTH_FAIL, USER_SIGN_UP_REQUEST, USER_SIGN_UP_SUCCESS, USER_VERIFY, ACCESSTOKEN } from \"./typeAuth\";\nimport { useEffect } from \"react\";\nimport axios from \"axios\";\nimport { SERVER } from \"../../component/MainPages/helpers/key\";\nimport setHeaderDefault from \"../../component/MainPages/helpers/SetHeader\";\n\nconst loadUser = () => async dispatch => {\n  if (localStorage[ACCESSTOKEN]) {\n    setHeaderDefault(localStorage[ACCESSTOKEN]);\n  }\n\n  try {\n    const {\n      data\n    } = await axios.get(`${SERVER}/user/info`);\n\n    if (data.success) {\n      dispatch({\n        type: USER_VERIFY,\n        payload: {\n          isAuth: true,\n          user: data.user\n        }\n      });\n    }\n  } catch (err) {\n    localStorage.removeItem(ACCESSTOKEN);\n    setHeaderDefault(null);\n    dispatch({\n      type: USER_VERIFY,\n      //\n      payload: {\n        isAuth: false,\n        //\n        user: null\n      }\n    });\n  }\n};\n\nloadUser();\nexport const userLogin = LoginFormData => async dispatch => {\n  try {\n    dispatch({\n      type: USER_LOGIN_REQUEST\n    });\n    const {\n      data\n    } = await axios.post(`${SERVER}/user/login`, LoginFormData);\n\n    if (data.success) {\n      localStorage.setItem(ACCESSTOKEN, data.accessToken);\n    }\n\n    await loadUser();\n    dispatch({\n      type: USER_LOGIN_SUCCESS\n    });\n  } catch (err) {\n    dispatch({\n      type: USER_AUTH_FAIL,\n      payload: {\n        isLoad: false,\n        error: err.response.data.message || \"Login is fail\"\n      }\n    });\n  }\n};","map":{"version":3,"sources":["C:/Users/DELL/Desktop/ShopFull/client/src/Redux/Auth/authAction.js"],"names":["USER_LOGIN_REQUEST","USER_LOGIN_SUCCESS","USER_AUTH_FAIL","USER_SIGN_UP_REQUEST","USER_SIGN_UP_SUCCESS","USER_VERIFY","ACCESSTOKEN","useEffect","axios","SERVER","setHeaderDefault","loadUser","dispatch","localStorage","data","get","success","type","payload","isAuth","user","err","removeItem","userLogin","LoginFormData","post","setItem","accessToken","isLoad","error","response","message"],"mappings":"AAAA,SACIA,kBADJ,EAEIC,kBAFJ,EAGIC,cAHJ,EAIIC,oBAJJ,EAKIC,oBALJ,EAMIC,WANJ,EAOIC,WAPJ,QAQO,YARP;AASA,SAASC,SAAT,QAA0B,OAA1B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,MAAT,QAAuB,uCAAvB;AACA,OAAOC,gBAAP,MAA6B,6CAA7B;;AAEA,MAAMC,QAAQ,GAAG,MAAM,MAAOC,QAAP,IAAoB;AACvC,MAAIC,YAAY,CAACP,WAAD,CAAhB,EAA+B;AAC3BI,IAAAA,gBAAgB,CAACG,YAAY,CAACP,WAAD,CAAb,CAAhB;AACH;;AAED,MAAI;AACA,UAAM;AAAEQ,MAAAA;AAAF,QAAW,MAAMN,KAAK,CAACO,GAAN,CAAW,GAAEN,MAAO,YAApB,CAAvB;;AAEA,QAAIK,IAAI,CAACE,OAAT,EAAkB;AACdJ,MAAAA,QAAQ,CAAC;AACLK,QAAAA,IAAI,EAAEZ,WADD;AAELa,QAAAA,OAAO,EAAE;AACLC,UAAAA,MAAM,EAAE,IADH;AAELC,UAAAA,IAAI,EAAEN,IAAI,CAACM;AAFN;AAFJ,OAAD,CAAR;AAOH;AACJ,GAZD,CAYE,OAAOC,GAAP,EAAY;AACVR,IAAAA,YAAY,CAACS,UAAb,CAAwBhB,WAAxB;AACAI,IAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACAE,IAAAA,QAAQ,CAAC;AACLK,MAAAA,IAAI,EAAEZ,WADD;AACc;AACnBa,MAAAA,OAAO,EAAE;AACLC,QAAAA,MAAM,EAAE,KADH;AACU;AACfC,QAAAA,IAAI,EAAE;AAFD;AAFJ,KAAD,CAAR;AAOH;AACJ,CA5BD;;AA8BAT,QAAQ;AAER,OAAO,MAAMY,SAAS,GAAIC,aAAD,IAAmB,MAAOZ,QAAP,IAAoB;AAC5D,MAAI;AACAA,IAAAA,QAAQ,CAAC;AACLK,MAAAA,IAAI,EAAEjB;AADD,KAAD,CAAR;AAGA,UAAM;AAAEc,MAAAA;AAAF,QAAW,MAAMN,KAAK,CAACiB,IAAN,CAClB,GAAEhB,MAAO,aADS,EAEnBe,aAFmB,CAAvB;;AAKA,QAAIV,IAAI,CAACE,OAAT,EAAkB;AACdH,MAAAA,YAAY,CAACa,OAAb,CAAqBpB,WAArB,EAAkCQ,IAAI,CAACa,WAAvC;AACH;;AAED,UAAMhB,QAAQ,EAAd;AAEAC,IAAAA,QAAQ,CAAC;AACLK,MAAAA,IAAI,EAAEhB;AADD,KAAD,CAAR;AAGH,GAlBD,CAkBE,OAAOoB,GAAP,EAAY;AACVT,IAAAA,QAAQ,CAAC;AACLK,MAAAA,IAAI,EAAEf,cADD;AAELgB,MAAAA,OAAO,EAAE;AACLU,QAAAA,MAAM,EAAE,KADH;AAELC,QAAAA,KAAK,EAAER,GAAG,CAACS,QAAJ,CAAahB,IAAb,CAAkBiB,OAAlB,IAA6B;AAF/B;AAFJ,KAAD,CAAR;AAOH;AACJ,CA5BM","sourcesContent":["import {\r\n    USER_LOGIN_REQUEST,\r\n    USER_LOGIN_SUCCESS,\r\n    USER_AUTH_FAIL,\r\n    USER_SIGN_UP_REQUEST,\r\n    USER_SIGN_UP_SUCCESS,\r\n    USER_VERIFY,\r\n    ACCESSTOKEN,\r\n} from \"./typeAuth\";\r\nimport { useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { SERVER } from \"../../component/MainPages/helpers/key\";\r\nimport setHeaderDefault from \"../../component/MainPages/helpers/SetHeader\";\r\n\r\nconst loadUser = () => async (dispatch) => {\r\n    if (localStorage[ACCESSTOKEN]) {\r\n        setHeaderDefault(localStorage[ACCESSTOKEN]);\r\n    }\r\n\r\n    try {\r\n        const { data } = await axios.get(`${SERVER}/user/info`);\r\n\r\n        if (data.success) {\r\n            dispatch({\r\n                type: USER_VERIFY,\r\n                payload: {\r\n                    isAuth: true,\r\n                    user: data.user,\r\n                },\r\n            });\r\n        }\r\n    } catch (err) {\r\n        localStorage.removeItem(ACCESSTOKEN);\r\n        setHeaderDefault(null);\r\n        dispatch({\r\n            type: USER_VERIFY, //\r\n            payload: {\r\n                isAuth: false, //\r\n                user: null,\r\n            },\r\n        });\r\n    }\r\n};\r\n\r\nloadUser();\r\n\r\nexport const userLogin = (LoginFormData) => async (dispatch) => {\r\n    try {\r\n        dispatch({\r\n            type: USER_LOGIN_REQUEST,\r\n        });\r\n        const { data } = await axios.post(\r\n            `${SERVER}/user/login`,\r\n            LoginFormData\r\n        );\r\n\r\n        if (data.success) {\r\n            localStorage.setItem(ACCESSTOKEN, data.accessToken);\r\n        }\r\n\r\n        await loadUser();\r\n\r\n        dispatch({\r\n            type: USER_LOGIN_SUCCESS,\r\n        });\r\n    } catch (err) {\r\n        dispatch({\r\n            type: USER_AUTH_FAIL,\r\n            payload: {\r\n                isLoad: false,\r\n                error: err.response.data.message || \"Login is fail\",\r\n            },\r\n        });\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}