{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Desktop\\\\ShopFull\\\\client\\\\src\\\\component\\\\Context\\\\userProvider.js\",\n    _s = $RefreshSig$();\n\nimport React, { useReducer, useEffect, useState } from \"react\";\nimport authReducer from \"./authReducer\";\nimport axios from \"axios\";\nimport { URL_SERVER, ACCESSTOKEN } from \"../MainPages/helpers/key\";\nimport setHeaderDefault from \"../MainPages/helpers/SetHeader\";\nimport Imgs from \"../MainPages/helpers/Imgs\";\nimport Products from \"../../api/product/getProduct\";\nimport getCategory from \"../../api/Category/getCategory\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const userContext = /*#__PURE__*/React.createContext();\n\nconst UserProvider = ({\n  children\n}) => {\n  _s();\n\n  const [userState, dispatch] = useReducer(authReducer, {\n    isLoad: false,\n    //\n    isAuth: false,\n    //\n    user: null //\n\n  });\n  const {\n    user\n  } = userState;\n  const [cart, setCart] = useState(user ? user.cart : []);\n  const [imgState, setImgState] = useState(Imgs);\n\n  const signUp = async DataForm => {\n    try {\n      const response = await axios.post(`${URL_SERVER}/register`, DataForm);\n      return response.data;\n    } catch (err) {\n      return err.response.data ? err.response.data : {\n        sucess: false,\n        //\n        msg: \"Internal Server Error\"\n      };\n    }\n  };\n\n  const LoginForm = async DataForm => {\n    try {\n      const response = await axios.post(`${URL_SERVER}/login`, DataForm);\n\n      if (response.data.success) {\n        localStorage.setItem(ACCESSTOKEN, response.data.accessToken); // localStorage.setItem(ACCESSTOKEN, true);\n      }\n\n      loadUser();\n      return response.data;\n    } catch (err) {\n      return err.response.data ? err.response.data : {\n        sucess: false,\n        msg: \"Internal server error\"\n      };\n    }\n  };\n\n  const handleLogOut = () => {\n    localStorage.removeItem(ACCESSTOKEN);\n    setHeaderDefault(null);\n    dispatch({\n      type: \"SET_AUTH\",\n      payload: {\n        isAuth: false,\n        userId: null\n      }\n    });\n  };\n\n  const sendProfileForm = async data => {\n    try {\n      const response = await axios.post(`${URL_SERVER}/save/profile`, data);\n      return response.data;\n    } catch (err) {\n      return err.response.data ? err.response.data : {\n        sucess: false,\n        msg: \"Internal server error\"\n      };\n    }\n  };\n\n  const loadUser = async () => {\n    if (localStorage[ACCESSTOKEN]) {\n      setHeaderDefault(localStorage[ACCESSTOKEN]);\n    }\n\n    try {\n      const res = await axios.get(`${URL_SERVER}/info`);\n\n      if (res.data.success) {\n        dispatch({\n          type: \"SET_AUTH\",\n          payload: {\n            isAuth: true,\n            user: res.data.user\n          }\n        });\n      }\n    } catch (err) {\n      localStorage.removeItem(ACCESSTOKEN);\n      setHeaderDefault(null);\n      dispatch({\n        type: \"SET_AUTH\",\n        //\n        payload: {\n          isAuth: false,\n          //\n          user: null\n        }\n      });\n    }\n  };\n\n  useEffect(() => {\n    loadUser();\n  }, []);\n  const [proState, setProState] = useState([]);\n\n  let data = (async () => {\n    let res = await Products();\n    return res;\n  })();\n\n  console.log(data);\n  const userContextData = {\n    signUp,\n    LoginForm,\n    handleLogOut,\n    dispatch,\n    sendProfileForm,\n    userState,\n    api: {\n      getCategory\n    },\n    imgData: [imgState, setImgState],\n    ProductCart: {\n      cart,\n      setCart\n    },\n    pros: data\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(userContext.Provider, {\n      value: userContextData,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n};\n\n_s(UserProvider, \"QJpApoM9/kpdoRU1ft0H13WxQkA=\");\n\n_c = UserProvider;\nexport default UserProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserProvider\");","map":{"version":3,"sources":["C:/Users/DELL/Desktop/ShopFull/client/src/component/Context/userProvider.js"],"names":["React","useReducer","useEffect","useState","authReducer","axios","URL_SERVER","ACCESSTOKEN","setHeaderDefault","Imgs","Products","getCategory","userContext","createContext","UserProvider","children","userState","dispatch","isLoad","isAuth","user","cart","setCart","imgState","setImgState","signUp","DataForm","response","post","data","err","sucess","msg","LoginForm","success","localStorage","setItem","accessToken","loadUser","handleLogOut","removeItem","type","payload","userId","sendProfileForm","res","get","proState","setProState","console","log","userContextData","api","imgData","ProductCart","pros"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,UAAhB,EAA4BC,SAA5B,EAAuCC,QAAvC,QAAuD,OAAvD;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,EAAqBC,WAArB,QAAwC,0BAAxC;AACA,OAAOC,gBAAP,MAA6B,gCAA7B;AACA,OAAOC,IAAP,MAAiB,2BAAjB;AACA,OAAOC,QAAP,MAAqB,8BAArB;AACA,OAAOC,WAAP,MAAwB,gCAAxB;;;AAEA,OAAO,MAAMC,WAAW,gBAAGZ,KAAK,CAACa,aAAN,EAApB;;AAEP,MAAMC,YAAY,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAAkB;AAAA;;AACnC,QAAM,CAACC,SAAD,EAAYC,QAAZ,IAAwBhB,UAAU,CAACG,WAAD,EAAc;AAClDc,IAAAA,MAAM,EAAE,KAD0C;AACnC;AACfC,IAAAA,MAAM,EAAE,KAF0C;AAEnC;AACfC,IAAAA,IAAI,EAAE,IAH4C,CAIlD;;AAJkD,GAAd,CAAxC;AAOA,QAAM;AAAEA,IAAAA;AAAF,MAAWJ,SAAjB;AACA,QAAM,CAACK,IAAD,EAAOC,OAAP,IAAkBnB,QAAQ,CAACiB,IAAI,GAAGA,IAAI,CAACC,IAAR,GAAe,EAApB,CAAhC;AACA,QAAM,CAACE,QAAD,EAAWC,WAAX,IAA0BrB,QAAQ,CAACM,IAAD,CAAxC;;AAEA,QAAMgB,MAAM,GAAG,MAAOC,QAAP,IAAoB;AAC/B,QAAI;AACA,YAAMC,QAAQ,GAAG,MAAMtB,KAAK,CAACuB,IAAN,CAClB,GAAEtB,UAAW,WADK,EAEnBoB,QAFmB,CAAvB;AAIA,aAAOC,QAAQ,CAACE,IAAhB;AACH,KAND,CAME,OAAOC,GAAP,EAAY;AACV,aAAOA,GAAG,CAACH,QAAJ,CAAaE,IAAb,GACDC,GAAG,CAACH,QAAJ,CAAaE,IADZ,GAED;AACIE,QAAAA,MAAM,EAAE,KADZ;AACmB;AACfC,QAAAA,GAAG,EAAE;AAFT,OAFN;AAMH;AACJ,GAfD;;AAgBA,QAAMC,SAAS,GAAG,MAAOP,QAAP,IAAoB;AAClC,QAAI;AACA,YAAMC,QAAQ,GAAG,MAAMtB,KAAK,CAACuB,IAAN,CAAY,GAAEtB,UAAW,QAAzB,EAAkCoB,QAAlC,CAAvB;;AAEA,UAAIC,QAAQ,CAACE,IAAT,CAAcK,OAAlB,EAA2B;AACvBC,QAAAA,YAAY,CAACC,OAAb,CAAqB7B,WAArB,EAAkCoB,QAAQ,CAACE,IAAT,CAAcQ,WAAhD,EADuB,CAEvB;AACH;;AAEDC,MAAAA,QAAQ;AACR,aAAOX,QAAQ,CAACE,IAAhB;AACH,KAVD,CAUE,OAAOC,GAAP,EAAY;AACV,aAAOA,GAAG,CAACH,QAAJ,CAAaE,IAAb,GACDC,GAAG,CAACH,QAAJ,CAAaE,IADZ,GAED;AAAEE,QAAAA,MAAM,EAAE,KAAV;AAAiBC,QAAAA,GAAG,EAAE;AAAtB,OAFN;AAGH;AACJ,GAhBD;;AAiBA,QAAMO,YAAY,GAAG,MAAM;AACvBJ,IAAAA,YAAY,CAACK,UAAb,CAAwBjC,WAAxB;AACAC,IAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACAS,IAAAA,QAAQ,CAAC;AACLwB,MAAAA,IAAI,EAAE,UADD;AAELC,MAAAA,OAAO,EAAE;AACLvB,QAAAA,MAAM,EAAE,KADH;AAELwB,QAAAA,MAAM,EAAE;AAFH;AAFJ,KAAD,CAAR;AAOH,GAVD;;AAWA,QAAMC,eAAe,GAAG,MAAOf,IAAP,IAAgB;AACpC,QAAI;AACA,YAAMF,QAAQ,GAAG,MAAMtB,KAAK,CAACuB,IAAN,CAClB,GAAEtB,UAAW,eADK,EAEnBuB,IAFmB,CAAvB;AAIA,aAAOF,QAAQ,CAACE,IAAhB;AACH,KAND,CAME,OAAOC,GAAP,EAAY;AACV,aAAOA,GAAG,CAACH,QAAJ,CAAaE,IAAb,GACDC,GAAG,CAACH,QAAJ,CAAaE,IADZ,GAED;AAAEE,QAAAA,MAAM,EAAE,KAAV;AAAiBC,QAAAA,GAAG,EAAE;AAAtB,OAFN;AAGH;AACJ,GAZD;;AAaA,QAAMM,QAAQ,GAAG,YAAY;AACzB,QAAIH,YAAY,CAAC5B,WAAD,CAAhB,EAA+B;AAC3BC,MAAAA,gBAAgB,CAAC2B,YAAY,CAAC5B,WAAD,CAAb,CAAhB;AACH;;AAED,QAAI;AACA,YAAMsC,GAAG,GAAG,MAAMxC,KAAK,CAACyC,GAAN,CAAW,GAAExC,UAAW,OAAxB,CAAlB;;AAEA,UAAIuC,GAAG,CAAChB,IAAJ,CAASK,OAAb,EAAsB;AAClBjB,QAAAA,QAAQ,CAAC;AACLwB,UAAAA,IAAI,EAAE,UADD;AAELC,UAAAA,OAAO,EAAE;AACLvB,YAAAA,MAAM,EAAE,IADH;AAELC,YAAAA,IAAI,EAAEyB,GAAG,CAAChB,IAAJ,CAAST;AAFV;AAFJ,SAAD,CAAR;AAOH;AACJ,KAZD,CAYE,OAAOU,GAAP,EAAY;AACVK,MAAAA,YAAY,CAACK,UAAb,CAAwBjC,WAAxB;AACAC,MAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACAS,MAAAA,QAAQ,CAAC;AACLwB,QAAAA,IAAI,EAAE,UADD;AACa;AAClBC,QAAAA,OAAO,EAAE;AACLvB,UAAAA,MAAM,EAAE,KADH;AACU;AACfC,UAAAA,IAAI,EAAE;AAFD;AAFJ,OAAD,CAAR;AAOH;AACJ,GA5BD;;AA8BAlB,EAAAA,SAAS,CAAC,MAAM;AACZoC,IAAAA,QAAQ;AACX,GAFQ,EAEN,EAFM,CAAT;AAIA,QAAM,CAACS,QAAD,EAAWC,WAAX,IAA0B7C,QAAQ,CAAC,EAAD,CAAxC;;AACA,MAAI0B,IAAI,GAAG,CAAC,YAAY;AACpB,QAAIgB,GAAG,GAAG,MAAMnC,QAAQ,EAAxB;AACA,WAAOmC,GAAP;AACH,GAHU,GAAX;;AAIAI,EAAAA,OAAO,CAACC,GAAR,CAAYrB,IAAZ;AAEA,QAAMsB,eAAe,GAAG;AACpB1B,IAAAA,MADoB;AAEpBQ,IAAAA,SAFoB;AAGpBM,IAAAA,YAHoB;AAIpBtB,IAAAA,QAJoB;AAKpB2B,IAAAA,eALoB;AAMpB5B,IAAAA,SANoB;AAOpBoC,IAAAA,GAAG,EAAE;AAAEzC,MAAAA;AAAF,KAPe;AAQpB0C,IAAAA,OAAO,EAAE,CAAC9B,QAAD,EAAWC,WAAX,CARW;AASpB8B,IAAAA,WAAW,EAAE;AAAEjC,MAAAA,IAAF;AAAQC,MAAAA;AAAR,KATO;AAUpBiC,IAAAA,IAAI,EAAE1B;AAVc,GAAxB;AAaA,sBACI;AAAA,2BACI,QAAC,WAAD,CAAa,QAAb;AAAsB,MAAA,KAAK,EAAEsB,eAA7B;AAAA,gBACKpC;AADL;AAAA;AAAA;AAAA;AAAA;AADJ,mBADJ;AAOH,CAlID;;GAAMD,Y;;KAAAA,Y;AAoIN,eAAeA,YAAf","sourcesContent":["import React, { useReducer, useEffect, useState } from \"react\";\r\nimport authReducer from \"./authReducer\";\r\nimport axios from \"axios\";\r\nimport { URL_SERVER, ACCESSTOKEN } from \"../MainPages/helpers/key\";\r\nimport setHeaderDefault from \"../MainPages/helpers/SetHeader\";\r\nimport Imgs from \"../MainPages/helpers/Imgs\";\r\nimport Products from \"../../api/product/getProduct\";\r\nimport getCategory from \"../../api/Category/getCategory\";\r\n\r\nexport const userContext = React.createContext();\r\n\r\nconst UserProvider = ({ children }) => {\r\n    const [userState, dispatch] = useReducer(authReducer, {\r\n        isLoad: false, //\r\n        isAuth: false, //\r\n        user: null,\r\n        //\r\n    });\r\n\r\n    const { user } = userState;\r\n    const [cart, setCart] = useState(user ? user.cart : []);\r\n    const [imgState, setImgState] = useState(Imgs);\r\n\r\n    const signUp = async (DataForm) => {\r\n        try {\r\n            const response = await axios.post(\r\n                `${URL_SERVER}/register`,\r\n                DataForm\r\n            );\r\n            return response.data;\r\n        } catch (err) {\r\n            return err.response.data\r\n                ? err.response.data\r\n                : {\r\n                      sucess: false, //\r\n                      msg: \"Internal Server Error\",\r\n                  };\r\n        }\r\n    };\r\n    const LoginForm = async (DataForm) => {\r\n        try {\r\n            const response = await axios.post(`${URL_SERVER}/login`, DataForm);\r\n\r\n            if (response.data.success) {\r\n                localStorage.setItem(ACCESSTOKEN, response.data.accessToken);\r\n                // localStorage.setItem(ACCESSTOKEN, true);\r\n            }\r\n\r\n            loadUser();\r\n            return response.data;\r\n        } catch (err) {\r\n            return err.response.data\r\n                ? err.response.data\r\n                : { sucess: false, msg: \"Internal server error\" };\r\n        }\r\n    };\r\n    const handleLogOut = () => {\r\n        localStorage.removeItem(ACCESSTOKEN);\r\n        setHeaderDefault(null);\r\n        dispatch({\r\n            type: \"SET_AUTH\",\r\n            payload: {\r\n                isAuth: false,\r\n                userId: null,\r\n            },\r\n        });\r\n    };\r\n    const sendProfileForm = async (data) => {\r\n        try {\r\n            const response = await axios.post(\r\n                `${URL_SERVER}/save/profile`,\r\n                data\r\n            );\r\n            return response.data;\r\n        } catch (err) {\r\n            return err.response.data\r\n                ? err.response.data\r\n                : { sucess: false, msg: \"Internal server error\" };\r\n        }\r\n    };\r\n    const loadUser = async () => {\r\n        if (localStorage[ACCESSTOKEN]) {\r\n            setHeaderDefault(localStorage[ACCESSTOKEN]);\r\n        }\r\n\r\n        try {\r\n            const res = await axios.get(`${URL_SERVER}/info`);\r\n\r\n            if (res.data.success) {\r\n                dispatch({\r\n                    type: \"SET_AUTH\",\r\n                    payload: {\r\n                        isAuth: true,\r\n                        user: res.data.user,\r\n                    },\r\n                });\r\n            }\r\n        } catch (err) {\r\n            localStorage.removeItem(ACCESSTOKEN);\r\n            setHeaderDefault(null);\r\n            dispatch({\r\n                type: \"SET_AUTH\", //\r\n                payload: {\r\n                    isAuth: false, //\r\n                    user: null,\r\n                },\r\n            });\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        loadUser();\r\n    }, []);\r\n\r\n    const [proState, setProState] = useState([]);\r\n    let data = (async () => {\r\n        let res = await Products();\r\n        return res;\r\n    })();\r\n    console.log(data);\r\n\r\n    const userContextData = {\r\n        signUp,\r\n        LoginForm,\r\n        handleLogOut,\r\n        dispatch,\r\n        sendProfileForm,\r\n        userState,\r\n        api: { getCategory },\r\n        imgData: [imgState, setImgState],\r\n        ProductCart: { cart, setCart },\r\n        pros: data,\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <userContext.Provider value={userContextData}>\r\n                {children}\r\n            </userContext.Provider>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default UserProvider;\r\n"]},"metadata":{},"sourceType":"module"}